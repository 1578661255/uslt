# Uni-Sign: ç»Ÿä¸€æ‰‹è¯­ç†è§£çš„è®ºæ–‡ä¸ä»£ç åˆ†æ

## ğŸ“š è®ºæ–‡æ ¸å¿ƒä¿¡æ¯

### æ ¸å¿ƒé—®é¢˜
è®ºæ–‡æ ‡é¢˜: **Uni-Sign: Toward Unified Sign Language Understanding at Scale**
- arXiv: 2501.15187
- å­¦æœ¯ä¼šè®®: ICLR 2025 æ¥æ”¶

**æ ¸å¿ƒé—®é¢˜å®šä¹‰:**
1. å¦‚ä½•åœ¨ç»Ÿä¸€æ¡†æ¶ä¸‹åŒæ—¶å¤„ç†å¤šé¡¹æ‰‹è¯­ç†è§£ä»»åŠ¡
2. å¦‚ä½•æœ‰æ•ˆèåˆæ‰‹åŠ¿å§¿æ€(Pose)å’ŒRGBè§†é¢‘ä¿¡æ¯
3. å¦‚ä½•åœ¨å¤§è§„æ¨¡æ•°æ®é›†ä¸Šè¿›è¡Œé«˜æ•ˆçš„é¢„è®­ç»ƒå’Œå¾®è°ƒ

### æ•´ä½“æ¡†æ¶ä¸‰é˜¶æ®µ

```
Stage 1: ä»…å§¿æ€é¢„è®­ç»ƒ (Pose-only Pre-training)
    â†“
Stage 2: RGB-å§¿æ€è”åˆé¢„è®­ç»ƒ (RGB-Pose Pre-training)
    â†“
Stage 3: ä¸‹æ¸¸ä»»åŠ¡å¾®è°ƒ (Downstream Fine-tuning)
```

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„è®¾è®¡

### æ•´ä½“å¤„ç†æµç¨‹
```
è¾“å…¥è§†é¢‘
  â†“
â”œâ”€ RGBåˆ†æ”¯ â”€â”€â”€â”€â†’ EfficientNet-B0 â”€â”€â”€â”€â†’ RGBç‰¹å¾
  â”œâ”€ å§¿æ€æå– â”€â”€â”€â”€â†’ èº«ä½“éƒ¨åˆ†åˆ†è§£ â”€â”€â”€â”€â†’ GCNç¼–ç  â”€â”€â”€â”€â†’ å§¿æ€ç‰¹å¾
  â”‚             (body, left, right, face)         â†“
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ç‰¹å¾èåˆ(PGF) â”€â”€â”€â”€â†’ mT5è§£ç å™¨ â”€â”€â”€â”€â†’ ç¿»è¯‘ç»“æœ
```

### æ¶æ„æ ¸å¿ƒæ¨¡å—

| æ¨¡å—åç§° | åŠŸèƒ½ | ä»£ç æ–‡ä»¶ |
|--------|------|--------|
| **å§¿æ€ç¼–ç å™¨** | æå–å’Œç¼–ç å¤šéƒ¨åˆ†éª¨éª¼ä¿¡æ¯ | `models.py` (GCNéƒ¨åˆ†) |
| **STGCN** | æ—¶ç©ºå›¾å·ç§¯ç½‘ç»œ | `stgcn_layers/` |
| **RGBéª¨å¹²ç½‘ç»œ** | è§†é¢‘ç‰¹å¾æå– | `models.py` (EfficientNet-B0) |
| **PGFèåˆæ¨¡å—** | å§¿æ€-RGB-ç‰¹å¾èåˆ | `models.py` (DeformableAttention2D) |
| **è¯­è¨€æ¨¡å‹** | mT5ç”¨äºæ–‡æœ¬ç”Ÿæˆ | `models.py` (MT5) |

---

## ğŸ”‘ å…³é”®æ¨¡å—è¯¦è§£

### 1. **å§¿æ€è§£æä¸éƒ¨åˆ†åˆ†è§£** (`datasets.py`)

**å‡½æ•°: `load_part_kp()`**
- **è¾“å…¥**: åŸå§‹éª¨éª¼æ•°æ® (skeleton, confidence scores)
- **å¤„ç†æµç¨‹**:
  ```python
  éª¨éª¼ç‚¹(133ä¸ªå…³é”®ç‚¹) 
    â†’ bodyéƒ¨åˆ†: [0, 3:11] (é¢ˆéƒ¨+èº¯å¹²)
    â†’ leftéƒ¨åˆ†: [91:112] (å·¦æ‰‹21ä¸ªå…³é”®ç‚¹)
    â†’ rightéƒ¨åˆ†: [112:133] (å³æ‰‹21ä¸ªå…³é”®ç‚¹)  
    â†’ face_alléƒ¨åˆ†: [é¢éƒ¨8+çœ¼ç›17] (è„¸éƒ¨å…³é”®ç‚¹)
  ```
- **è¾“å‡º**: æ ‡å‡†åŒ–çš„éƒ¨åˆ†ç‰¹å¾å­—å…¸
- **æ ‡å‡†åŒ–æ–¹æ³•**: `crop_scale()` å‡½æ•°
  - è®¡ç®—æœ‰æ•ˆå…³é”®ç‚¹çš„è¾¹ç•Œæ¡†
  - å½’ä¸€åŒ–åˆ°[-1, 1]èŒƒå›´
  - ç½®ä¿¡åº¦é˜ˆå€¼: 0.3

### 2. **STGCNæ—¶ç©ºå›¾å·ç§¯ç½‘ç»œ** (`stgcn_layers/`)

**æ ¸å¿ƒç±»:**
- `Graph`: æ„å»ºéª¨éª¼å›¾ç»“æ„(è·ç¦»ç­–ç•¥, max_hop=1)
- `GCN_unit`: å›¾å·ç§¯å•å…ƒ
  - è‡ªé€‚åº”é‚»æ¥çŸ©é˜µå­¦ä¹ 
  - å¯é€‰æ®‹å·®è¿æ¥
- `STGCN_block`: æ—¶ç©ºå›¾å·ç§¯å—
  - ç»“åˆGCN(ç©ºé—´)å’ŒTCN(æ—¶é—´)
  - åŒ…å«æ‰¹æ ‡å‡†åŒ–å’Œdropout

**å¤„ç†æµç¨‹:**
```
å§¿æ€ç‰¹å¾ (B, T, V, 3)  [æ‰¹å¤§å°, æ—¶é—´, å…³é”®ç‚¹, åæ ‡+ç½®ä¿¡åº¦]
  â†“
çº¿æ€§æŠ•å½± â†’ (B, C, T, V)  [æŠ•å½±åˆ°éšè—ç»´åº¦]
  â†“
ç©ºé—´STGCN â†’ å­¦ä¹ ç©ºé—´ä¾èµ–
  â†“
æ—¶é—´STGCN â†’ å­¦ä¹ æ—¶é—´åŠ¨æ€
  â†“
å¹³å‡æ± åŒ– â†’ (B, T, C)
```

### 3. **RGBæ”¯æŒåˆ†æ”¯** (`models.py` - å¯é€‰)

**ç»„ä»¶:**
- **éª¨å¹²ç½‘ç»œ**: EfficientNet-B0 (é¢„è®­ç»ƒ)
- **ç‰¹å¾æŠ•å½±**: Conv2d (1280 â†’ hidden_dim)
- **èåˆæœºåˆ¶**: DeformableAttention2D (å¯å˜å½¢æ³¨æ„åŠ›)

**PGF(Pose-Gesture Fusion)æ¨¡å—:**
```
left_hand/right_hand RGBç‰¹å¾
  â†“
Deformable Attention 2D (å­¦ä¹ offset)
  â†“
ä¸ç›¸åº”bodyéƒ¨åˆ†çš„GCNç‰¹å¾è¿›è¡Œèåˆ
  â†“
Gateæœºåˆ¶ (Tanhæ¿€æ´») åŠ¨æ€åŠ æƒ
```

### 4. **è¯­è¨€æ¨¡å‹å¤´** (`models.py`)

**ä½¿ç”¨æ¨¡å‹**: mT5-base (å¤šè¯­è¨€T5)

**å¤„ç†æµç¨‹:**
```
èåˆç‰¹å¾ (B, T, 768)
  â†“
å‰ç¼€Token: "Translate sign language video to {ä¸­æ–‡/English}:"
  â†“
æ‹¼æ¥ [prefix_embeds, èåˆç‰¹å¾]
  â†“
mT5ç¼–ç å™¨å¤„ç†
  â†“
ç”Ÿæˆç›®æ ‡æ–‡æœ¬ (æœ€å¤š50ä¸ªtoken)
```

**æŸå¤±å‡½æ•°:**
- CrossEntropyLoss with label_smoothing (é»˜è®¤0.2)
- ignore_index = -100 (padding token)

---

## ğŸ“Š æ•°æ®é›†æ”¯æŒ

| æ•°æ®é›† | ç±»å‹ | RGBè·¯å¾„ | Poseè·¯å¾„ | æ ‡ç­¾æ ¼å¼ |
|-------|------|--------|---------|---------|
| **CSL_News** | ä¸­æ–‡æ–°é—» | `dataset/CSL_News/rgb_format` | `dataset/CSL_News/pose_format` | JSON |
| **CSL_Daily** | ä¸­æ–‡æ—¥å¸¸ | `dataset/CSL_Daily/sentence-crop` | `dataset/CSL_Daily/pose_format` | æ–‡æœ¬æ–‡ä»¶ |
| **WLASL** | è‹±æ–‡è¯æ±‡ | `dataset/WLASL/rgb_format` | `dataset/WLASL/pose_format` | æ–‡æœ¬æ–‡ä»¶ |
| **How2Sign** | è‹±æ–‡å¥å­ | `dataset/How2Sign/rgb_format` | `dataset/WLASL/pose_format` | æ–‡æœ¬æ–‡ä»¶ |
| **OpenASL** | è‹±æ–‡ASL | `dataset/OpenASL/rgb_format` | `dataset/WLASL/pose_format` | æ–‡æœ¬æ–‡ä»¶ |

---

## ğŸ¯ è®­ç»ƒæµç¨‹åˆ†æ

### Stage 1: ä»…å§¿æ€é¢„è®­ç»ƒ (`pre_training.py`)

**è¾“å…¥æ•°æ®:**
```python
src_input: {
    'body': (B, T, V, 3),           # èº¯å¹²éƒ¨åˆ†
    'left': (B, T, V, 3),           # å·¦æ‰‹éƒ¨åˆ†
    'right': (B, T, V, 3),          # å³æ‰‹éƒ¨åˆ†
    'face_all': (B, T, V, 3),       # è„¸éƒ¨éƒ¨åˆ†
    'attention_mask': (B, T)
}
tgt_input: {
    'gt_sentence': ['ç¿»è¯‘ç»“æœ1', 'ç¿»è¯‘ç»“æœ2', ...]  # åœ°çœŸæ ‡ç­¾
}
```

**å¤„ç†æµç¨‹:**
1. **å¤šéƒ¨åˆ†ç‰¹å¾æå–** (4ä¸ªGCNåˆ†æ”¯)
   - æ¯éƒ¨åˆ†ç‹¬ç«‹é€šè¿‡GCNç¼–ç 
   - leftå’Œrightå…±äº«æƒé‡
2. **ç‰¹å¾èåˆ**
   - å°†4ä¸ªéƒ¨åˆ†çš„ç‰¹å¾åœ¨tokenç»´åº¦æ‹¼æ¥
   - æ·»åŠ å¯å­¦ä¹ çš„éƒ¨åˆ†å‚æ•°
   - çº¿æ€§æŠ•å½±åˆ°768ç»´(mT5è¾“å…¥ç»´åº¦)
3. **æ–‡æœ¬ç”Ÿæˆ**
   - æ·»åŠ ä»»åŠ¡å‰ç¼€Token
   - é€šè¿‡mT5ç”Ÿæˆç¿»è¯‘ç»“æœ
4. **æŸå¤±è®¡ç®—**
   - äº¤å‰ç†µæŸå¤± + æ ‡ç­¾å¹³æ»‘

**å…³é”®è¶…å‚æ•°:**
```bash
batch_size: 16
gradient_accumulation_steps: 8
epochs: 20
learning_rate: 3e-4
optimizer: AdamW
warmup_epochs: 0
```

### Stage 2: RGB-å§¿æ€è”åˆé¢„è®­ç»ƒ

**æ–°å¢æ¨¡å—:**
- RGBéª¨å¹²ç½‘ç»œæ¿€æ´» (`--rgb_support` å‚æ•°)
- PGFèåˆæ¨¡å—å¯ç”¨
- Gateæœºåˆ¶åŠ¨æ€åŠ æƒ

**èåˆè¿‡ç¨‹:**
```python
for each hand part (left, right):
    # 1. ä»RGBä¸­é‡‡æ ·å¯¹åº”å¸§
    rgb_feat_selected = rgb_features[sampled_indices]
    
    # 2. Deformable Attentionèåˆ
    fused = deformable_attention(pose_feat, rgb_feat, pose_init)
    
    # 3. GateåŠ æƒ
    gate_score = gate_network([fused, pose_feat])
    fused_final = gate_score * fused + (1 - gate_score) * pose_feat
    
    # 4. æ›¿æ¢GCNç‰¹å¾
    gcn_feat[batch, :, indices] = fused_final
```

### Stage 3: ä¸‹æ¸¸ä»»åŠ¡å¾®è°ƒ (`fine_tuning.py`)

**å¾®è°ƒé…ç½®:**
- åŠ è½½Stage 2é¢„è®­ç»ƒæƒé‡ (`--finetune` å‚æ•°)
- ä½¿ç”¨ä¸‹æ¸¸ä»»åŠ¡æ•°æ®é›†
- ç±»ä¼¼çš„è®­ç»ƒæµç¨‹ï¼Œä½†:
  - å¯é€‰å¼€å¯RGBæ”¯æŒ
  - è¯„ä¼°æŒ‡æ ‡: BLEU, ROUGE
  - æ”¯æŒå¤šä¸ªä»»åŠ¡: SLT(ç¿»è¯‘), ISLR(è¯†åˆ«), CSLR(è¯†åˆ«)

---

## ğŸ“‚ ä»£ç æ–‡ä»¶èŒè´£æ˜ å°„

### æ ¸å¿ƒè®­ç»ƒè„šæœ¬

| æ–‡ä»¶ | è¡Œæ•° | ä¸»è¦èŒè´£ |
|-----|------|--------|
| `pre_training.py` | 272 | Stage 1-2é¢„è®­ç»ƒä¸»å¾ªç¯ |
| `fine_tuning.py` | 337 | Stage 3å¾®è°ƒä¸»å¾ªç¯ |
| `models.py` | 336 | Uni_Signæ¨¡å‹å®šä¹‰ |
| `datasets.py` | 668 | æ•°æ®åŠ è½½å’Œé¢„å¤„ç† |
| `utils.py` | 547 | åˆ†å¸ƒå¼è®­ç»ƒã€æ—¥å¿—ã€å·¥å…·å‡½æ•° |

### å§¿æ€å¤„ç†æ¨¡å—

| æ–‡ä»¶ | è¡Œæ•° | ä¸»è¦èŒè´£ |
|-----|------|--------|
| `stgcn_layers/stgcn_block.py` | 127 | STGCNå—å®šä¹‰ |
| `stgcn_layers/gcn_utils.py` | 171 | å›¾æ„å»ºå·¥å…· |
| `stgcn_layers/__init__.py` | 1 | Graphå’Œget_stgcn_chainå¯¼å‡º |

### å…¶ä»–æ¨¡å—

| æ–‡ä»¶ | è¡Œæ•° | ä¸»è¦èŒè´£ |
|-----|------|--------|
| `deformable_attention_2d.py` | 311 | RGB-å§¿æ€èåˆçš„å¯å˜å½¢æ³¨æ„åŠ› |
| `config.py` | 44 | æ•°æ®é›†è·¯å¾„é…ç½® |
| `SLRT_metrics.py` | 322 | è¯„ä¼°æŒ‡æ ‡(BLEU, ROUGE) |
| `demo/online_inference.py` | 152 | å®æ—¶æ¨ç†æ¼”ç¤º |
| `demo/pose_extraction.py` | 93 | å§¿æ€æå–å·¥å…· |

---

## ğŸ”„ è®ºæ–‡æ–¹æ³•ä¸ä»£ç å®ç°å¯¹åº”è¡¨

### å¤šéƒ¨åˆ†éª¨éª¼ç¼–ç 

**è®ºæ–‡æ–¹æ³•:**
- å°†133ä¸ªå…³é”®ç‚¹åˆ†è§£ä¸º4ä¸ªéƒ¨åˆ†: èº«ä½“(body), å·¦æ‰‹(left), å³æ‰‹(right), è„¸éƒ¨(face)
- æ¯éƒ¨åˆ†ç‹¬ç«‹ç¼–ç åèåˆ

**ä»£ç å®ç°:**
- `datasets.py::load_part_kp()` - å…³é”®ç‚¹åˆ†è§£
- `models.py::Uni_Sign.__init__()` - 4ä¸ªç‹¬ç«‹GCNæ¨¡å—
- `models.py::Uni_Sign.forward()` - å¹¶è¡Œå¤„ç†4ä¸ªéƒ¨åˆ†

### æ—¶ç©ºå»ºæ¨¡

**è®ºæ–‡æ–¹æ³•:**
- STGCNç”¨äºå­¦ä¹ ç©ºé—´ä¾èµ–å’Œæ—¶é—´åŠ¨æ€

**ä»£ç å®ç°:**
- `stgcn_layers/stgcn_block.py::STGCN_block` - æ—¶ç©ºå›¾å·ç§¯å—
- `models.py` - gcn_moduleså’Œfusion_gcn_modules (ç©ºé—´â†’æ—¶é—´)

### å§¿æ€-RGBèåˆ

**è®ºæ–‡æ–¹æ³•:**
- Pose-Gesture Fusion (PGF)æ¨¡å—
- å¯å˜å½¢æ³¨æ„åŠ›å­¦ä¹ ç©ºé—´å¯¹é½
- Gateæœºåˆ¶åŠ¨æ€åŠ æƒ

**ä»£ç å®ç°:**
- `deformable_attention_2d.py::DeformableAttention2D` - PGFæ ¸å¿ƒ
- `models.py::gather_feat_pose_rgb()` - èåˆé€»è¾‘
- `models.py::fusion_gate` - é—¨æœºåˆ¶

### æ–‡æœ¬ç”Ÿæˆ

**è®ºæ–‡æ–¹æ³•:**
- ä½¿ç”¨mT5ä½œä¸ºè¯­è¨€æ¨¡å‹å¤´
- æ”¯æŒä¸­è‹±æ–‡ç¿»è¯‘

**ä»£ç å®ç°:**
- `models.py::forward()` - èåˆç‰¹å¾â†’mT5è¾“å…¥
- mT5é¢„è®­ç»ƒæƒé‡åŠ è½½

### åˆ†å¸ƒå¼è®­ç»ƒ

**è®ºæ–‡æ–¹æ³•:**
- ä½¿ç”¨DeepSpeedè¿›è¡Œå¤§è§„æ¨¡åˆ†å¸ƒå¼è®­ç»ƒ

**ä»£ç å®ç°:**
- `pre_training.py/fine_tuning.py::main()` - DeepSpeedé›†æˆ
- `utils.py::init_deepspeed()` - DeepSpeedåˆå§‹åŒ–
- å¤šGPUåŒæ­¥è®­ç»ƒæ”¯æŒ

---

## ğŸ› ï¸ æ‰§è¡Œæµç¨‹è¯¦è§£

### é¢„è®­ç»ƒæ‰§è¡Œæµç¨‹ (pre_training.py)

```python
main()
â”œâ”€ init_distributed_mode_ds()          # åˆå§‹åŒ–åˆ†å¸ƒå¼
â”œâ”€ set_seed()                          # å›ºå®šéšæœºç§å­
â”œâ”€ åŠ è½½è®­ç»ƒ/éªŒè¯æ•°æ®
â”‚  â”œâ”€ S2T_Dataset_news()               # CSL_Newsæ•°æ®é›†
â”‚  â””â”€ DataLoader with collate_fn
â”œâ”€ åˆ›å»ºUni_Signæ¨¡å‹
â”œâ”€ init_deepspeed()                    # æ·±åº¦åŠ é€Ÿå¼•æ“åˆå§‹åŒ–
â”œâ”€ åˆ›å»ºä¼˜åŒ–å™¨å’Œå­¦ä¹ ç‡è°ƒåº¦å™¨
â””â”€ è®­ç»ƒå¾ªç¯ (epochs)
   â””â”€ train_one_epoch()
      â”œâ”€ æ•°æ®æµ: src_input (4éƒ¨åˆ†å§¿æ€) â†’ tgt_input (ç›®æ ‡æ–‡æœ¬)
      â”œâ”€ å‰å‘ä¼ æ’­: model(src_input, tgt_input)
      â”‚  â”œâ”€ GCNç‰¹å¾æå–(4éƒ¨åˆ†)
      â”‚  â”œâ”€ RGBèåˆ(å¯é€‰)
      â”‚  â”œâ”€ ç‰¹å¾èåˆâ†’mT5è¾“å…¥
      â”‚  â””â”€ äº¤å‰ç†µæŸå¤±è®¡ç®—
      â”œâ”€ åå‘ä¼ æ’­: model.backward(loss)
      â””â”€ è¯„ä¼°: evaluate() â†’ BLEU/ROUGEæŒ‡æ ‡
```

### å¾®è°ƒæ‰§è¡Œæµç¨‹ (fine_tuning.py)

```python
main()
â”œâ”€ åŠ è½½é¢„è®­ç»ƒæ£€æŸ¥ç‚¹ (Stage 1/2)
â”œâ”€ åˆ›å»ºä¸‹æ¸¸ä»»åŠ¡æ•°æ®é›†
â”‚  â””â”€ å¯èƒ½çš„ä»»åŠ¡: SLT(ç¿»è¯‘), ISLR/CSLR(è¯†åˆ«)
â””â”€ ç›¸ä¼¼çš„è®­ç»ƒæµç¨‹
   â”œâ”€ ä¼˜åŒ–å™¨å¯é€‰å†»ç»“æŸäº›å±‚
   â””â”€ è¯„ä¼°: ä»»åŠ¡ç‰¹å®šæŒ‡æ ‡
```

---

## ğŸ“Š è¶…å‚æ•°é…ç½®ä½“ç³»

### Stage 1é¢„è®­ç»ƒ (train_stage1.sh)

```bash
# è®¡ç®—é…ç½®
batch_size = 16
gradient_accumulation_steps = 8
effective_batch = 16 * 8 = 128

# ä¼˜åŒ–å™¨
optimizer = AdamW
lr = 3e-4
weight_decay = 1e-4

# å­¦ä¹ ç‡è°ƒåº¦
warmup_epochs = 0
total_epochs = 20
scheduler = cosine

# å…¶ä»–
max_length = 256 (åºåˆ—é•¿åº¦)
hidden_dim = 256 (GCNç‰¹å¾ç»´åº¦)
label_smoothing = 0.2
```

### Stage 2é¢„è®­ç»ƒ (train_stage2.sh)

```bash
ç›¸åŒé…ç½®ä½†å¯ç”¨:
--rgb_support
```

### Stage 3å¾®è°ƒ (train_stage3.sh)

```bash
ä¸é¢„è®­ç»ƒç›¸ä¼¼ï¼Œå¯é€‰:
--finetune <path_to_stage2_checkpoint>
--dataset {CSL_Daily, WLASL, How2Sign, OpenASL}
```

---

## ğŸ” å…³é”®è®¾è®¡å†³ç­–

### 1. å¤šéƒ¨åˆ†åˆ†è§£çš„ä¼˜åŠ¿
- âœ… æ¯éƒ¨åˆ†å…³é”®ç‚¹å°‘ï¼Œè®¡ç®—é«˜æ•ˆ
- âœ… å……åˆ†åˆ©ç”¨æ‰‹è¯­ç‰¹æœ‰çš„éƒ¨åˆ†åŠ¨ä½œç‰¹å¾
- âœ… ä¾¿äºRGB-å§¿æ€å¯¹é½(ä»…æ‰‹éƒ¨)

### 2. STGCNé€‰æ‹©ç†ç”±
- âœ… ç†è®ºä¸Šèƒ½å­¦ä¹ éª¨éª¼çš„ç©ºé—´æ‹“æ‰‘
- âœ… ç›¸æ¯”Transformeræ›´è½»é‡çº§
- âœ… å·²è¢«CoSignéªŒè¯æœ‰æ•ˆ

### 3. mT5ä½œä¸ºè¯­è¨€æ¨¡å‹
- âœ… å¤šè¯­è¨€é¢„è®­ç»ƒï¼Œå¤©ç„¶æ”¯æŒä¸­è‹±æ–‡
- âœ… Seq2Seqæ¡†æ¶é€‚é…æ–‡æœ¬ç”Ÿæˆ
- âœ… ç›¸æ¯”Decoder-onlyæ¨¡å‹å‚æ•°å°‘

### 4. ä¸‰é˜¶æ®µè®­ç»ƒç­–ç•¥
- âœ… Stage 1: å¤§è§„æ¨¡unlabeledæ•°æ®é¢„è®­ç»ƒ(ä»…å§¿æ€)
- âœ… Stage 2: RGBè¡¥å……æ¨¡æ€å­¦ä¹ 
- âœ… Stage 3: ä¸‹æ¸¸ä»»åŠ¡å¾®è°ƒ(labeledæ•°æ®)

---

## ğŸ“ˆ è¯„ä¼°æŒ‡æ ‡

### æ”¯æŒçš„è¯„ä¼°æŒ‡æ ‡ (SLRT_metrics.py)

| æŒ‡æ ‡ | ç”¨é€” | è®¡ç®—æ–¹æ³• |
|-----|------|--------|
| **BLEU-4** | æ–‡æœ¬ç¿»è¯‘è´¨é‡ | SacreBLEUå®ç° |
| **ROUGE** | æ‘˜è¦ç›¸ä¼¼åº¦ | ROUGE-L/1/2 |
| **WER** | è¯é”™è¯¯ç‡(è¯†åˆ«ä»»åŠ¡) | ç¼–è¾‘è·ç¦» |

---

## ğŸš€ æ¨ç†æµç¨‹

### ç¦»çº¿æ¨ç†

```python
# å‰å‘ä¼ æ’­å¾—åˆ°èåˆç‰¹å¾
stack_out = model(src_input, tgt_input)

# ç”Ÿæˆç¿»è¯‘ç»“æœ
output = model_without_ddp.generate(
    inputs_embeds = stack_out['inputs_embeds'],
    attention_mask = stack_out['attention_mask'],
    max_new_tokens = 100,
    num_beams = 4,  # Beam search
)

# è§£ç 
translation = tokenizer.decode(output, skip_special_tokens=True)
```

### åœ¨çº¿æ¨ç† (demo/online_inference.py)

- æ”¯æŒå®æ—¶è§†é¢‘è¾“å…¥
- ä½¿ç”¨è½»é‡çº§å§¿æ€æå–å™¨
- æµå¼å¤„ç†è¾“å…¥å¸§

---

## ğŸ’¾ æ£€æŸ¥ç‚¹ä¿å­˜ç­–ç•¥

### ä¿å­˜æ—¶æœº

1. **æ¯ä¸ªEpochå**: `checkpoint_{epoch}.pth`
2. **æœ€ä½³æ€§èƒ½**: `best_checkpoint.pth` (åŸºäºéªŒè¯é›†BLEU)
3. **å¿«é€Ÿä¸­æ–­**: `checkpoint.pth` (æ¯quick_breakæ­¥)

### ä¿å­˜å†…å®¹

```python
{
    'model': get_requires_grad_dict(model_without_ddp)
    # ä»…ä¿å­˜å¯è®­ç»ƒå‚æ•°
}
```

---

## âœ… æ€»ç»“

**Uni-Sign** æ˜¯ä¸€ä¸ªè®¾è®¡ç²¾å¦™çš„ç»Ÿä¸€æ‰‹è¯­ç†è§£æ¡†æ¶:

1. **åˆ›æ–°æ€§**: å¤šéƒ¨åˆ†éª¨éª¼+RGBèåˆ+ç»Ÿä¸€è¯­è¨€æ¨¡å‹
2. **å¯æ‰©å±•æ€§**: æ”¯æŒ5ä¸ªæ•°æ®é›†ï¼Œå¤šä¸ªä¸‹æ¸¸ä»»åŠ¡
3. **å·¥ç¨‹å®Œå–„**: åˆ†å¸ƒå¼è®­ç»ƒã€DeepSpeedé›†æˆã€æ¨¡å—åŒ–è®¾è®¡
4. **é«˜æ•ˆæ€§**: STGCNè½»é‡çº§ï¼Œå¯å˜å½¢æ³¨æ„åŠ›ç²¾å‡†èåˆ

ä»£ç å®ç°ä¸¥æ ¼éµå¾ªè®ºæ–‡æ–¹æ³•ï¼Œå®Œæ•´ä¿ç•™äº†è®­ç»ƒã€è¯„ä¼°å’Œæ¨ç†çš„å…¨æµç¨‹ã€‚

